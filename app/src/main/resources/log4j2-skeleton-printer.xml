<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="ERROR">
  <Properties>
    <!-- Define log file location for SkeletonPrinter -->
    <Property name="skeletonLogFile">${sys:user.home}/.brokk/skeleton-printer.log</Property>
    <Property name="pattern">%d{yyyy-MM-dd HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n</Property>
  </Properties>

  <Appenders>
    <!-- File appender for skeleton printer analysis -->
    <RollingFile name="SkeletonPrinterFileLogger"
                 fileName="${skeletonLogFile}"
                 filePattern="${sys:user.home}/.brokk/skeleton-printer.log.%d{yyyy-MM-dd}">
      <PatternLayout pattern="${pattern}"/>
      <Policies>
        <TimeBasedTriggeringPolicy interval="1" modulate="true"/>
        <SizeBasedTriggeringPolicy size="10MB"/>
      </Policies>
      <DefaultRolloverStrategy max="5"/>
    </RollingFile>

    <!-- Console appender for essential output -->
    <Console name="SkeletonPrinterConsole" target="SYSTEM_OUT">
      <PatternLayout pattern="%msg%n"/>
    </Console>
  </Appenders>

  <Loggers>
    <!-- Detailed logging for TreeSitter analysis -->
    <Logger name="io.github.jbellis.brokk.analyzer.TreeSitterAnalyzer" level="${sys:skeleton.printer.log.level:-info}" additivity="false">
      <AppenderRef ref="SkeletonPrinterFileLogger"/>
    </Logger>

    <Logger name="io.github.jbellis.brokk.analyzer.CppAnalyzer" level="${sys:skeleton.printer.log.level:-info}" additivity="false">
      <AppenderRef ref="SkeletonPrinterFileLogger"/>
    </Logger>

    <Logger name="io.github.jbellis.brokk.analyzer.NamespaceProcessor" level="${sys:skeleton.printer.log.level:-info}" additivity="false">
      <AppenderRef ref="SkeletonPrinterFileLogger"/>
    </Logger>

    <!-- Suppress verbose external library logs -->
    <Logger name="org.eclipse" level="error" additivity="false">
      <AppenderRef ref="SkeletonPrinterFileLogger"/>
    </Logger>

    <!-- Root logger - send most logs to file, but allow essential output to console -->
    <Root level="warn">
      <AppenderRef ref="SkeletonPrinterFileLogger"/>
    </Root>
  </Loggers>
</Configuration>